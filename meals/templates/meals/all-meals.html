{% extends "dashboard/base.html" %}
{% load i18n static %}

{% block title %}{% trans 'Meals' %}{% endblock %}

{% block content %}


<h1 class=" mb-5 text-center">
{% if nb_of_groups != 1 %}
{% trans "All Meals" %}
{% else %}
{% trans "Meals of " %}{{group.name}}
{% endif %}
</h1>

{% if meals %}
<div class="d-flex mt-5 pt-5 justify-content-center flex-wrap ">
  {% for meal in meals %}
    <div class="card card-recipe shadow mx-2">
      <div class="row justify-content-center">
        <div class="col-lg-3 order-lg-2">
          <div class="card-recipe-image">
            {% if meal.picture %}
              <img src="{{ meal.picture.url }}">
            {% else %}
              <img src="{% static 'assets/img/illustrations/meal_default.jpeg' %}" alt="Meal picture"  >
            {% endif %}
          </div>
        </div>
      </div>
      
      <div class="card-body pt-0 pt-md-4">
        
        <div class="text-center">
          <h3>
            {{meal.eaten_at|date:"d M Y"}}
          </h3>
          <a href="{% url 'add-existing-dish' meal.slug%}" class="card-recipe-btn-small">{% trans 'Dishes' %} <i class="fa-solid fa-plus fa-xs"></i></a>
          {% for dish in meal.dishes.all %}
          <a href="{% url 'dish-detail' dish.slug %}" class="darkest-color">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                {% if dish.picture%}
                <img src="{{dish.picture.url}}" class="rounded-circle small-img">
                {% endif %}
              </div>
              <div>
                <p class="my-auto">{{dish.name}}</p>
              </div>
              <div>
              {% if dish.averagereview != None %}
                {{dish.averagereview}}
              {% endif %}
              </div>
            </div>
          </a>
          {% endfor %}
          <hr class="my-4">

          <a href="{% url 'add-music' meal.slug%}" class="card-recipe-btn-small">{% trans 'Music' %} <i class="fa-solid fa-plus fa-xs"></i></a>
          {% for music in meal.musics.all %}
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <p class="my-auto">{{music.title}}</p>
            </div>
            <div>
              {{music.artist}}
            </div>
          </div>
          {% endfor %}

          <hr class="my-4">

          <a href="{% url 'add-anecdote' meal.slug%}" class="card-recipe-btn-small">{% trans 'Anecdotes' %} <i class="fa-solid fa-plus fa-xs"></i></a>
          {% for anecdote in meal.anecdotes.all %}
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <p class="my-auto">{{anecdote.message}}</p>
            </div>
            
          </div>
          {% endfor %}
          
          
          
        </div>
        <div class="edit-button">
              <a href="{% url 'edit-meal'  meal.slug%}" class="dark-color small"><i class="fa fa-pencil"></i>{% trans 'Edit meal' %}</a>
          </div>
      </div>
    </div>
  {% endfor %}
</div>
{% else %}
<div class="d-flex p-2 justify-content-center flex-wrap">
<a class="btn" href="{% url 'add-meal' %}">
        <div class="sketch-box">
            <div class="card-cta border-0 sketch-box">
                <img class="card-icon mx-auto" src="{% static 'assets/img/icons/add-100.png' %}" alt="Card image cap" width="100px" >
                <div class="card-body">
                {% trans 'ADD FIRST MEAL' %}
                </div>
            </div>
        </div>
</a>
</div>
{% endif %}

<!-- Floating button -->
<a href="{% url 'add-meal' %}">
<div class="kfloat" data-bs-toggle="tooltip" title="{% trans 'Add Meal' %}">
<div class="my-float">+</div>
</div>
</a>
 

{% endblock %}
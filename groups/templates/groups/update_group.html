{% extends "dashboard/base.html" %}
{% load i18n %}
{% block title %}{% trans 'Update' %} {{object.name}}{% endblock title %}
{% block content %}
<div class="container mt-5 pb-2">
    <div class="abstract-form mt-2">
     {% if circle_form.errors %}
        <div class="alert alert-danger alert-dismissible" role="alert">
            <div id="form_errors">
                {% for key, value in circle_form.errors.items %}
                <strong>{{ value }}</strong>
                {% endfor %}
            </div>
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        {% endif %}
    <h1 class="text-center">{% trans 'Update' %} {{object.name}} </h1>
    <div class="row justify-content-center">
        
       
        <div class="form-content">
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="form-row justify-content-center mt-5">
                    
                        <div class="form-group text-center">
                            <label>{%trans 'Name of the Circle' %}</label>
                            {{ form.name }}

                        
                       <label class="text-center">{% trans 'Upload New Picture of the Circle' %}</label>
                       <input
  type="file"
  id="fileElem"
  multiple
  accept="image/*"
  name="group_pic"
  style="display:none" 
  />
<a href="#" id="fileSelect" class="abstract-btn-upload-update" style="background: url('{{object.group_pic.url}}') rgba(255, 255, 255, 0.8); background-size: contain; background-blend-mode: multiply; line-height:10; display:grid;">{% trans 'Upload Picture of the Circle' %}</a>
<div id="fileList" class="mt-3 color-light">
  <p>{% trans 'No files selected!' %}</p>
</div>
                        
                    </div>
                </div>
                <div class="row justify-content-center">
                <div class="form-group text-center kselect">
                <label>{% trans 'Admin of the Circle' %}</label>
                </br>
                    {{form.leader}}
                </div>
                </div>
              
                <div class="row justify-content-center">
                <button type="submit" class="btn btn-kdark btn-rounded">{% trans 'Save' %}</button>
                </div>
                <div class="row justify-content-center">

                <a href="{% url 'circle_detail' object.uuid object.slug %}" class="color-brand text-uppercase mt-2">{% trans 'Cancel' %}</a>
                </div>
            </form>
        </div>
    </div>
    </div>
</div>

<div>

</div>
{% endblock content %}

{% block extrajs %}
<script>
const fileSelect = document.getElementById("fileSelect"),
  fileElem = document.getElementById("fileElem"),
  fileList = document.getElementById("fileList");

fileSelect.addEventListener(
  "click",
  (e) => {
    if (fileElem) {
      fileElem.click();
    }
    e.preventDefault(); // prevent navigation to "#"
  },
  false
);

fileElem.addEventListener("change", handleFiles, false);

function handleFiles() {
  if (!this.files.length) {
    fileList.innerHTML = "<p>No files selected!'</p>";
  } else {
    fileList.innerHTML = "";
    const list = document.createElement("ul");
    fileList.appendChild(list);
    for (let i = 0; i < this.files.length; i++) {
      const li = document.createElement("li");
      list.appendChild(li);

      const img = document.createElement("img");
      img.src = URL.createObjectURL(this.files[i]);
      img.height = 60;
      img.onload = () => {
        URL.revokeObjectURL(img.src);
      };
      li.appendChild(img);
      const info = document.createElement("span");
      info.innerHTML = `${this.files[i].name}: ${this.files[i].size} bytes`;
      li.appendChild(info);
    }
  }
}
</script>
{% endblock extrajs%}